var invoices,reservedLobby,currentTab=0,isShownMenu=!1,isShownServices=!1,isValidateTable=!1,tab=document.getElementsByClassName("tab"),showInvoice=e=>{var t=document,o=parseInt(t.getElementById("tableQuantity").value)+parseInt(t.getElementById("reservedTable").value);invoices={groom:t.getElementById("nameGroom").value,bride:t.getElementById("nameBride").value,date:t.getElementById("dateWedding").value,tableQuantity:o,unitPrice:totalFood,totalFood:totalFood*o,totalService:totalServices,total:totalFood*o+totalServices,deposit:t.getElementById("deposit").value,balance:totalFood*o+totalServices-parseInt(t.getElementById("deposit").value),reservedServices:reservedServices,shift:document.querySelector('input[name="shift"]:checked').value,lobbyName:reservedLobby.name};var a=document.getElementById("modalInvoice");info=a.getElementsByTagName("span");for(let e=0;e<info.length;e++)info[e].innerHTML=invoices[[Object.keys(invoices)[e]]];let n=0,d=invoices.reservedServices.map(e=>`<tr><td>${++n}</td><td>${e.name}</td><td>${e.cost}</td><td>${e.quantity}</td><td>${e.cost*e.quantity}</td></tr>`),s=new Date;document.getElementById("payment-date").innerHTML=`${s.getDate()}/${s.getMonth()+1}/${s.getFullYear()}`,a.getElementsByTagName("tbody")[0].innerHTML=d.join("")},moveTab=e=>{var t=document.getElementById("btnPrev"),o=document.getElementById("btnNext"),a=document.getElementsByClassName("bs-wizard-step");return tab[currentTab].style.display="none",o.dataset.target="",o.dataset.toggle="",currentTab+=e,console.log("current tab",currentTab),currentTab<=3?(1===e?(showTab(currentTab),a[currentTab-1].className=a[currentTab-1].className.replace(" active"," complete"),a[currentTab].className=a[currentTab].className.replace(" disable"," active"),t.disabled=!1):(showTab(currentTab),a[currentTab+1].className=a[currentTab+1].className.replace(" active"," disable"),a[currentTab].className=a[currentTab].className.replace(" complete"," active"),0===currentTab&&(t.disabled=!0)),3===currentTab?(o.children[0].className=o.children[0].className.replace(" fa-angle-right"," fa-check"),console.log(o.children[0])):o.children[0].className=o.children[0].className.replace(" fa-check"," fa-angle-right")):(showTab(currentTab=3),o.dataset.target="#exampleModal",o.dataset.toggle="modal",showInvoice()),!0};function showTab(e){if(tab[e].style.display="block",1===currentTab){var t=document.querySelector('input[name="lobby"]:checked').value;reservedLobby={name:document.getElementById(t).getElementsByTagName("td")[0].innerHTML,tableMax:document.getElementById(t).getElementsByTagName("td")[2].innerHTML,costMin:document.getElementById(t).getElementsByTagName("td")[3].innerHTML},document.querySelector('input[name="dateWedding"]').value=document.getElementById("dateWedding").value,document.querySelector('input[name="tableMax"]').value=reservedLobby.tableMax,document.getElementById("costMin").innerHTML="Minimum price per table: <i>"+reservedLobby.costMin+"</i>",isValidateTable&&validate("tableQuantity")}}var successField=e=>(e.classList.contains("danger")&&(e.className=e.className.replace(" danger"," success")),e.classList.contains("success")||(e.className+=" success"),!0),unsuccessField=e=>(e.classList.contains("success")&&(e.className=e.className.replace(" success"," danger")),e.classList.contains("danger")||(e.className+=" danger"),!1),validate=e=>{var t=document.getElementById(e);if("dateWedding"===e)return new Date<new Date(t.value)?successField(t):unsuccessField(t);if("tableQuantity"===e||"reservedTable"===e){isValidateTable=!0;let e=parseInt(document.getElementById("tableQuantity").value)+parseInt(document.getElementById("reservedTable").value);return e>reservedLobby.tableMax||e<=0?(unsuccessField(document.getElementById("reservedTable")),unsuccessField(document.getElementById("tableQuantity"))):(successField(document.getElementById("reservedTable")),successField(document.getElementById("tableQuantity")))}return""==t.value?unsuccessField(t):successField(t)},validateRadio=()=>null==document.querySelector('input[name="lobby"]:checked')?(document.getElementById("alert-lobby").className+=" active",!1):(document.getElementById("alert-lobby").classList.remove("active"),!0),validateTotal=()=>totalFood<reservedLobby.costMin?(document.getElementById("alert-food").className+=" active",!1):(document.getElementById("alert-food").classList.remove("active"),!0),confirm=()=>{var e=!0,t=document.getElementsByClassName("tab")[currentTab].getElementsByClassName("form-control");for(let o=0;o<t.length;o++)t[o].id&&(e=validate(t[o].id)&&e);return 0===currentTab&&(e=validateRadio()&&e),2===currentTab&&(e=validateTotal()&&e),e},lobbies=[{idLobby:"S1",nameLobby:"Sảnh A",typeLobby:"A",tableMax:40,costMin:1e6,note:"A",statusLobby:1},{idLobby:"S2",nameLobby:"Sảnh B",typeLobby:"B",tableMax:50,costMin:11e5,note:"B",statusLobby:1},{idLobby:"S3",nameLobby:"Sảnh C",typeLobby:"C",tableMax:40,costMin:12e5,note:"",statusLobby:1},{idLobby:"S4",nameLobby:"Sảnh D",typeLobby:"D",tableMax:60,costMin:14e5,note:"",statusLobby:1},{idLobby:"S5",nameLobby:"Sảnh E",typeLobby:"E",tableMax:50,costMin:16e5,note:"E",statusLobby:1},{idLobby:"S6",nameLobby:"Sảnh F",typeLobby:"F",tableMax:40,costMin:12e5,note:"",statusLobby:1},{idLobby:"S7",nameLobby:"Sảnh G",typeLobby:"G",tableMax:60,costMin:14e5,note:"G",statusLobby:1},{idLobby:"S8",nameLobby:"Sảnh H",typeLobby:"H",tableMax:50,costMin:16e5,note:"H",statusLobby:1}],filter=()=>{var e=lobbies.map(e=>{if(1===e.statusLobby)return`<tr id='${e.idLobby}'><td>${e.nameLobby}</td><td>${e.typeLobby}</td><td>${e.tableMax}</td><td>${e.costMin}</td><td>${e.note}</td><td><div class="radio"><input type="radio" name="lobby" value=${e.idLobby}></div></td></tr>`});0===e.length?document.getElementById("tableLobby").getElementsByTagName("tbody")[0].innerHTML="Không tồn tại sảnh phù hợp":document.getElementById("tableLobby").getElementsByTagName("tbody")[0].innerHTML=e.join("")},reservedfood=[],menu=[{idFood:"MA1",nameFood:"Món A",costFood:1e5,note:"Khai vị",statusFood:1},{idFood:"MA2",nameFood:"Món B",costFood:2e5,note:" Món chính",statusFood:1},{idFood:"MA3",nameFood:"Món C",costFood:3e5,note:"Món chính",statusFood:1},{idFood:"MA4",nameFood:"Món D",costFood:4e5,note:"Món chính",statusFood:1},{idFood:"MA5",nameFood:"Món E",costFood:5e5,note:"Tráng miệng",statusFood:1},{idFood:"MA6",nameFood:"Món F",costFood:6e5,note:"Tráng miệng",statusFood:1},{idFood:"MA7",nameFood:"Món G",costFood:3e5,note:"Món chính",statusFood:1},{idFood:"MA8",nameFood:"Món H",costFood:4e5,note:"Món chính",statusFood:1},{idFood:"MA9",nameFood:"Món I",costFood:5e5,note:"Tráng miệng",statusFood:1},{idFood:"MA10",nameFood:"Món G",costFood:6e5,note:"Tráng miệng",statusFood:1}],showMenu=()=>{if(!isShownMenu){var e=menu.map(e=>{if(1===e.statusFood)return`<tr><td>${e.nameFood}</td><td>${e.note}</td><td>${e.costFood}</td><td><input type="checkbox" id='${e.idFood}menu' onclick="updateReservedFood(this,'${e.idFood}')"></td></tr>`});document.getElementById("menu").getElementsByTagName("tbody")[0].innerHTML=e.join(""),isShownMenu=!0}},totalFood=0,updateReservedFood=(e,t)=>{let o=document.getElementById("food").getElementsByTagName("tbody")[0];if(e.checked){let e=menu.find(e=>e.idFood==t),o={id:e.idFood,name:e.nameFood,cost:e.costFood,note:""};totalFood+=o.cost,reservedfood.push(o)}else if(!e.checked){let e=document.getElementById("menu").getElementsByTagName("tbody")[0].getElementsByTagName("input");var a=t+"menu";for(let t=0;t<e.length;t++)if(e[t].id==a){e[t].checked=!1;break}reservedfood=reservedfood.filter(e=>(e.id==t&&(totalFood-=e.cost),e.id!=t))}document.getElementById("totalFood").innerHTML=totalFood;let n=reservedfood.map(e=>`<tr><td>${e.name}</td><td><input type="text" name="note" id='${e.id}note' value="${e.note}" onblur="updateNote(this,'${e.id}')"></td><td class="costFood">${e.cost}</td><td><input name="food" value='${e.id}' type="checkbox" id='${e.id}' onclick="updateReservedFood(this,'${e.id}')" checked></td></tr>`);o.innerHTML=n.join("")},updateNote=(e,t)=>{for(let o=0;o<reservedfood.length;o++)if(t==reservedfood[o].id)return void(reservedfood[o].note=e.value)},reservedServices=[],servicesMenu=[{idService:"DV1",nameService:"Dịch vụ 1",costService:1e5,statusService:0},{idService:"DV2",nameService:"Dịch vụ 2",costService:2e5,statusService:1},{idService:"DV3",nameService:"Dịch vụ 3",costService:3e5,statusService:1},{idService:"DV4",nameService:"Dịch vụ 4",costService:4e5,statusService:1},{idService:"DV5",nameService:"Dịch vụ 5",costService:5e5,statusService:1},{idService:"DV6",nameService:"Dịch vụ 6",costService:3e5,statusService:1},{idService:"DV7",nameService:"Dịch vụ 7",costService:4e5,statusService:1},{idService:"DV8",nameService:"Dịch vụ 8",costService:5e5,statusService:1},{idService:"DV9",nameService:"Dịch vụ 9",costService:3e5,statusService:1},{idService:"DV10",nameService:"Dịch vụ 10",costService:4e5,statusService:1},{idService:"DV11",nameService:"Dịch vụ 11",costService:5e5,statusService:1}],showServices=()=>{if(!isShownServices){let e=servicesMenu.map(e=>{if(1===e.statusService)return`<tr><td>${e.nameService}</td><td>${e.costService}</td><td><input type="checkbox" id='${e.idService}menu' onclick="updateReservedService(this,'${e.idService}')"></td></tr>`});document.getElementById("servicesMenu").getElementsByTagName("tbody")[0].innerHTML=e.join(""),isShownServices=!0}},totalServices=0,updateReservedService=(e,t)=>{let o=document.getElementById("services").getElementsByTagName("tbody")[0];if(e.checked){let e=servicesMenu.find(e=>e.idService==t),o={id:e.idService,name:e.nameService,cost:e.costService,quantity:1};totalServices+=o.cost,reservedServices.push(o)}else if(!e.checked){let e=document.getElementById("servicesMenu").getElementsByTagName("tbody")[0].getElementsByTagName("input");var a=t+"menu";for(let t=0;t<e.length;t++)if(e[t].id==a){e[t].checked=!1;break}reservedServices=reservedServices.filter(e=>(e.id==t&&totalAllServices(e,0),e.id!=t))}document.getElementById("totalServices").innerHTML=totalServices;let n=reservedServices.map(e=>`<tr><td>${e.name}</td><td><input id='${e.id}quantity' type="number" min=1 name="quantity" value=${e.quantity} onblur="updateQuantity(this,'${e.id}')"></td><td>${e.cost}</td><td><input type="checkbox" name="service" value=${e.id} id='${e.id}' onclick="updateReservedService(this,'${e.id}')" checked></td></tr>`);o.innerHTML=n.join("")},updateQuantity=(e,t)=>{for(let o=0;o<reservedServices.length;o++)if(quantity=parseInt(e.value),t==reservedServices[o].id)return quantity<=0&&(quantity=1,e.textContent=1),totalAllServices(reservedServices[o],quantity),reservedServices[o].quantity=quantity,void console.log(e.value)},totalAllServices=(e,t)=>{totalServices=totalServices-e.cost*e.quantity+e.cost*t,document.getElementById("totalServices").innerHTML=totalServices};